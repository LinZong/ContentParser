(function(){/*
 Advertisement Library 
  Version     2.31.7.70f6e3c2e19c0c8ea2fc12a92d1dbca378cddf59
  Build Date  20191127


 This library uses a part of prototype.js.
 - Prototype is freely distributable under the terms of an MIT-style license.
   For details, see the Prototype web site: http://www.prototypejs.org/

 This library uses `Ads` namespace.
 This library has no Object.prototype pollution.
*/
(function(g){function h(e){if(f[e])return f[e].exports;var d=f[e]={i:e,l:!1,exports:{}};g[e].call(d.exports,d,d.exports,h);d.l=!0;return d.exports}var f={};h.m=g;h.c=f;h.d=function(e,d,a){h.o(e,d)||Object.defineProperty(e,d,{enumerable:!0,get:a})};h.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});Object.defineProperty(e,"__esModule",{value:!0})};h.t=function(e,d){d&1&&(e=h(e));if(d&8||d&4&&"object"===typeof e&&e&&e.__esModule)return e;
var a=Object.create(null);h.r(a);Object.defineProperty(a,"default",{enumerable:!0,value:e});if(d&2&&"string"!=typeof e)for(var b in e)h.d(a,b,function(a){return e[a]}.bind(null,b));return a};h.n=function(e){var d=e&&e.__esModule?function(){return e["default"]}:function(){return e};h.d(d,"a",d);return d};h.o=function(e,d){return Object.prototype.hasOwnProperty.call(e,d)};h.p="";return h(h.s=0)})([function(g,h,f){f(1);f(2);f(3);f(4);f(5);f(6);f(7);f(8);f(9);f(10);f(11);f(12);f(13);f(14);f(15);f(16);
f(17);f(18);f(19);f(20);g.exports=f(21)},function(g,h){g=(new Function("return this;"))();g=g.Ads=g.Ads||{};g.__internal__={};g.__internal__.Polyfill={};g.protocol=g.protocol||location.protocol;"https:"!==g.protocol&&(g.protocol="http:");g.pathBase=g.pathBase||g.protocol+"//ads.nicovideo.jp";g.resBase=g.resBase||g.protocol+"//res.ads.nicovideo.jp";g.version="2.31.7.70f6e3c2e19c0c8ea2fc12a92d1dbca378cddf59";g.buildDate="20191127";g.ALL=-1;g.isDebugMode=!1;g.removeLoadedSctipt=!0;g.iframeResizeRetryCounts=
{};h=document.getElementsByTagName("meta");for(var f=0;f<h.length;f++)"ads-pagevariant"==h[f].name&&(g.pageVariant=h[f].content),"ads-loaderinterval"==h[f].name&&(g.loaderInterval=h[f].content);g.pageUrl=g.pageUrl||"";g.pageVariant=g.pageVariant||"";g.loaderInterval=g.loaderInterval||500;g.did=g.did||null},function(g,h){(function(){(new Function("return this;"))().Ads.__internal__.Class={create:function(f){var e=function(){this.initialize&&this.initialize.apply(this,arguments)};if(f)for(var d in f)e[d]=
f[d];return e},mixin:function(f,e){for(var d in e)e.hasOwnProperty(d)&&"undefined"===typeof f[d]&&("[object Object]"===Object.prototype.toString.call(e[d])?f[d]=this.mixin({},e[d]):"[object Array]"===Object.prototype.toString.call(e[d])?f[d]=this.mixin([],e[d]):f[d]=e[d]);return f}}})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;d.Utility=d.Class.create({setup:function(){window.addEventListener("message",this.listenResponseMessage,!1);if("undefined"===
typeof document.hasFocus||/Android 2\.2/.test(navigator.userAgent)||/Android 2\.3/.test(navigator.userAgent)){var a=!0;this.addEvent(window,"focus",function(){a=!0});this.addEvent(window,"blur",function(){a=!1});this.hasFocus=function(){return a}}else this.hasFocus=function(){return document.hasFocus()}},extend:function(a,b){for(var c in b)a[c]=b[c]},hasFocus:function(){},addEvent:function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d):a.attachEvent?a.attachEvent("on"+b,c):a[b]=function(){a["on"+
b]();c()}},isBackCompat:!document.compatMode||!!document.compatMode.match(/.*BackCompat.*/i),toQueryString:function(a){var b="",c;for(c in a)null!==a[c]&&"undefined"!==typeof a[c]&&(b+=c+"="+encodeURIComponent(a[c])+"&");return b.slice(0,b.length-1)},deleteEmptyFromArray:function(a){for(var b=[],c=0;c<a.length;c++)a[c]&&""!==a[c]&&b.push(a[c]);return b},unique:function(a){for(var b={},c=[],d=0;d<a.length;d++)a[d]in b||(b[a[d]]=!0,c.push(a[d]));return c},map:function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d]));
return c},indexOf:function(a,b){if("[object Array]"!=Object.prototype.toString.call(a))return-1;for(var c=0;c<a.length;c++)if(a[c]===b)return c;return-1},count:function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b},hasIntersection:function(a,b){for(var c=0,d=a.length;c<d;c++)for(var e=0,f=b.length;e<f;e++)if(a[c]===b[e])return!0;return!1},getScroll:function(){return"undefined"!==typeof f.pageXOffset&&"undefined"!==typeof f.pageYOffset?{left:f.pageXOffset,top:f.pageYOffset}:{left:document.documentElement.scrollLeft||
document.body.scrollLeft,top:document.documentElement.scrollTop||document.body.scrollTop}},getPageUrl:function(a){return a||location.href},getPageVariant:function(){return e.pageVariant.match(/\W/)||64<e.pageVariant.length?"":e.pageVariant},toArray:function(a){if(!a)return[];for(var b=a.length||0,c=Array(b);b--;)c[b]=a[b];return c},TABLE_ELEMENT_INNERHTML_BUGGY:function(){try{var a=document.createElement("table");if(a&&a.tBodies)return a.innerHTML="<tbody><tr><td>test</td></tr></tbody>","undefined"==
typeof a.tBodies[0]}catch(b){return!0}}(),getContentFromAnonymousElement:function(a,b,c){var e=d.Utility.INSERTION_TRANSLATIONS.tags[a];a=document.createElement("div");var f=!!e;!f&&c&&(f=!0,e=["","",0]);if(f)for(a.innerHTML="&#160;"+e[0]+b+e[1],a.removeChild(a.firstChild),b=e[2];b--;)a=a.firstChild;else a.innerHTML=b;return d.Utility.toArray(a.childNodes)},INSERTION_TRANSLATIONS:{before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,
b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},tags:{TABLE:["<table>","</table>",1],TBODY:["<table><tbody>","</tbody></table>",2],TR:["<table><tbody><tr>","</tr></tbody></table>",3],TD:["<table><tbody><tr><td>","</td></tr></tbody></table>",4],SELECT:["<select>","</select>",1]}},updateElement:function(a,b){if(void 0==a.tagName||null===a.tagName)return!1;var c=a.tagName.toUpperCase();if(d.Utility.TABLE_ELEMENT_INNERHTML_BUGGY)if(c in d.Utility.INSERTION_TRANSLATIONS.tags){b=
d.Utility.getContentFromAnonymousElement(c,b);c=0;for(var e;e=b[c];c++)a.appendChild(e)}else a.innerHTML+=b;else a.innerHTML+=b;return!0},cumulativeOffset:function(a){var b=0,c=0;if(a.parentNode){do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a)}return{left:c,top:b}},canPlayMp4:function(){var a=document.createElement("video");return"undefined"==typeof a.canPlayType?!1:!!a.canPlayType('video/mp4; codecs="avc1.4D401E, mp4a.40.2"')},postRequestMessageToIframe:function(a){void 0!==a.contentWindow&&
null!==a.contentWindow&&void 0!==JSON&&void 0!==JSON.parse&&void 0!==a.contentWindow.postMessage&&a.hasAttribute("src")&&a.contentWindow.postMessage(JSON.stringify({type:"request"}),e.pathBase)},listenResponseMessage:function(a){if(a.origin===e.pathBase&&void 0!==JSON&&void 0!==JSON.parse){try{var b=JSON.parse(a.data)}catch(k){return}if(void 0!==b.type&&"response"===b.type&&void 0!==b.frameId&&void 0!==b.height&&b.frameId in e.iframeResizeRetryCounts&&(a=document.getElementById(b.frameId),null!==
a))if(600<b.height&&(b.height=600),a.height<b.height&&600===b.height){a.height=b.height;a=document.getElementById(a.parentElement.id);try{var c=new CustomEvent("inner_height_changed",{detail:b.frameId})}catch(k){c=document.createEvent("CustomEvent"),c.initCustomEvent("inner_height_changed",!1,!1,b.frameId)}a.dispatchEvent(c)}else 100>e.iframeResizeRetryCounts[b.frameId]&&(e.iframeResizeRetryCounts[b.frameId]++,setTimeout(e.__internal__.Utility.postRequestMessageToIframe,150,a))}},observationLazyLoad:function(a,
b,c){function d(a,b){a.forEach(function(a){a.isIntersecting&&(a=a.target,a.src=a.getAttribute(c),a.removeAttribute(c),b.unobserve(a))})}if(0!==a.length&&"src"!==c){b={rootMargin:b};b=e.__internal__.Polyfill.isIntersectionObserverPolyfill?new e.__internal__.Polyfill.IntersectionObserver(d,b):new IntersectionObserver(d,b);for(var f=0;f<a.length;f++)b.observe(a[f])}},generateRandomString:function(a){for(var b="",c=0;c<a;c++)b+="abcdefghijklmnopqrstuvwxyz0123456789"[Math.floor(36*Math.random())];return b},
replaceTimestampToRandomString:function(a){return a.replace(/\[timestamp\]/g,e.__internal__.Utility.generateRandomString(32))},observationViewableImpression:function(a,b,c,k,f,g,h){function t(a,e){a.forEach(function(a){a.intersectionRatio>=g?void 0==p&&(p=setTimeout(function(){d.Api.logViewableImpression(b,c,k,f);e.unobserve(a.target)},h)):void 0!=p&&(clearTimeout(p),p=void 0)})}if(0!==a.length){var u={threshold:g};u=e.__internal__.Polyfill.isIntersectionObserverPolyfill?new e.__internal__.Polyfill.IntersectionObserver(t,
u):new IntersectionObserver(t,u);for(var p=void 0,n=0;n<a.length;n++)u.observe(a[n])}}})})()},function(g,h){(function(){(new Function("return this;"))().Ads.__internal__.Event={definedEvents:{},addListener:function(f,e,d){"undefined"===typeof this.definedEvents[f]&&(this.definedEvents[f]=[]);this.definedEvents[f].push({func:e,scope:d||this})},fireEvent:function(f,e){var d=Array.prototype.slice.call(arguments).slice(1);if("undefined"!==typeof this.definedEvents[f])for(var a=0,b=this.definedEvents[f].length;a<
b;a++){var c=this.definedEvents[f][a];c.func.apply(c.scope,d)}},removeListener:function(f,e){if("undefined"!==typeof this.definedEvents[f]&&"function"===typeof e)for(var d=0,a=this.definedEvents[f].length;d<a;d++)if(this.definedEvents[f][d].func===e){this.definedEvents[f].splice(d,1);break}}}})()},function(g,h){(function(){var f=(new Function("return this;"))().Ads.__internal__;f.PresetAdvertisementSet=f.Class.create({});f.Utility.extend(f.PresetAdvertisementSet.prototype,{presetAdsString:null,presetAds:null,
initialize:function(e){try{var d=JSON.parse(e);Array.isArray(d)&&(this.presetAds=d,this.presetAdsString=e)}catch(a){}},getPresetAds:function(){return this.presetAds},getPresetAdsString:function(){return this.presetAdsString},isNull:function(){return null===this.presetAds}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.Advertisement=d.Class.create();d.Utility.extend(e.Advertisement.prototype,{zone:null,segments:null,elementId:null,view:null,template:null,
count:null,impression:null,adsize:null,width:null,height:null,keepAspectRatio:null,follow:null,migiue:null,eventListener:null,landscapeFlag:!1,closeableActionElementId:null,closeableButtonText:["\u5e83\u544a\u3092\u9589\u3058\u308b","\u5e83\u544a\u3092\u8868\u793a"],forceLazyLoad:!1,lazyLoadViewMargin:null,lazyLoadUrlName:null,viewImpThreshold:null,viewImpDelay:null,presetAds:null,initialize:function(a){if("number"!==typeof a.zone)throw Error("zone is not number.");this.zone=a.zone;this.segments=
a.segments||{};this.count="number"===typeof a.count?a.count:1;this.impression="number"===typeof a.impression?a.impression:1;this.view=a.view&&a.view.display?a.view:new e.View;this.follow=a.follow||null;this.eventListener="eventListeners"in a?a.eventListeners:null;this.migiue="string"===typeof a.migiue?a.migiue:null;this.closeableActionElementId="string"===typeof a.closeableActionElementId?a.closeableActionElementId:null;null!==this.closeableActionElementId&&"object"===typeof a.closeableButtonText&&
2===a.closeableButtonText.length&&(this.closeableButtonText=a.closeableButtonText);this.presetAds=(new d.PresetAdvertisementSet(a.presetAds)).getPresetAds();this.forceLazyLoad="boolean"===typeof a.forceLazyLoad?a.forceLazyLoad:!1;this.lazyLoadViewMargin="string"===typeof a.lazyLoadViewMargin?a.lazyLoadViewMargin:null;this.lazyLoadUrlName="string"===typeof a.lazyLoadUrlName?a.lazyLoadUrlName:null;this.viewImpThreshold="number"===typeof a.viewImpThreshold?a.viewImpThreshold:null;this.viewImpDelay="number"===
typeof a.viewImpDelay?a.viewImpDelay:null;if(null!==this.eventListener){if("render"in this.eventListener&&"function"!==typeof this.eventListener.render)throw Error("render must be a function.");if("empty"in this.eventListener&&"function"!==typeof this.eventListener.empty)throw Error("empty must be a function.");}if(this.count===e.ALL&&2===this.impression)throw Error("You can not set [count: ALL] and [impression: 2] at a time.");this.width="number"===typeof a.width?a.width:null;this.height="number"===
typeof a.height?a.height:null;this.keepAspectRatio="boolean"===typeof a.keepAspectRatio?a.keepAspectRatio:!0;this.adsize="object"===typeof a.size?this.adsize=a.size:this.adsize;if(null!==this.adsize){var b=this;setInterval(function(){var a=!1;if(void 0==screen.orientation)a=!1;else if(90===screen.orientation.angle||270===screen.orientation.angle)a=!0;a!=b.landscapeFlag&&b.update()},1E3)}},update:function(){document.getElementById(this.elementId)&&(90===screen.orientation.angle||270===screen.orientation.angle?
(this.resize(this.adsize.landscape.width,this.adsize.landscape.height),this.landscapeFlag=!0):(this.resize(this.adsize.portrait.width,this.adsize.portrait.height),this.landscapeFlag=!1))},set:function(a,b){var c=document.getElementById(a);if(c)this.getElement=function(){return c};else throw Error(a+" is not found.");if(b&&"function"!==typeof b)throw Error("template is not function.");var k=!1;null!==this.adsize&&(void 0===screen.orientation?(k=!0,this.width=Math.min(this.adsize.landscape.width,this.adsize.portrait.width),
this.height=Math.min(this.adsize.landscape.height,this.adsize.portrait.height)):(90===screen.orientation.angle||270===screen.orientation.angle?(this.width=this.adsize.landscape.width,this.height=this.adsize.landscape.height,this.landscapeFlag=!0):(this.width=this.adsize.portrait.width,this.height=this.adsize.portrait.height),this.adsize.portrait.width===this.adsize.landscape.width&&this.adsize.landscape.height===this.adsize.portrait.height&&(k=!0)));this.elementId=a;this.template=b;d.AdvertisementLoader.register(this);
this.follow&&new e.Follow(this.follow.elementId||this.elementId,this.follow.margin,this.follow.bottom);if(null!==this.adsize){var f=this;k||window.addEventListener("orientationchange",function(){f.update()})}return this},getElement:function(){var a=document.getElementById(this.elementId);a&&(this.getElement=function(){return a});return a},resize:function(a,b){for(var c=document.getElementById(this.elementId).children,d=0;d<c.length;d++)if(cn=c[d],"DIV"===cn.tagName&&null!==cn.firstElementChild&&(cn=
cn.firstElementChild),null!==cn.firstElementChild&&"A"===cn.tagName&&"IMG"===cn.firstElementChild.tagName)cn.firstElementChild.width=a,cn.firstElementChild.height=b;else if("IFRAME"===cn.tagName){cn.width=a;cn.height=b;break}this.width=a;this.height=b}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;d.AdvertisementAssembler=d.Class.create();d.Utility.extend(d.AdvertisementAssembler.prototype,{parameters:null,segments:null,impression:null,all:!1,
presetData:!1,initialize:function(a){this.parameters={};this.parameters.zone=[];this.segments={};this.presetData=!1;for(var b=0;b<a.length;b++){var c=a[b];this.all||(this.all=c.count===e.ALL);for(var k=0;k<(c.count===e.ALL?1:c.count);k++)for(var f in this.parameters)this.parameters[f]=this.parameters[f].concat(c[f]);null===this.impression&&(this.impression="number"===typeof c.impression?c.impression:null);this.presetData||"undefined"===typeof c.presetAds||null===c.presetAds||(this.presetData=!0);
0!==d.Utility.count(c.segments)&&d.Utility.extend(this.segments,c.segments)}},isAll:function(){return this.all},getZone:function(){return d.Utility.deleteEmptyFromArray(this.parameters.zone)}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;d.AdvertisementLoader=d.Class.create({group:[],register:function(a){if(Array.isArray(a.presetAds))(new d.AdvertisementLoader).addPresetAds(a);else{for(var b=0,c=this.group.length;b<c;b++)if(this.group[b].checkRequestGroup(a)){this.group[b].add(a);
return}this.group[b]=new d.AdvertisementLoader;this.group[b].add(a)}},registers:function(a){if(Array.isArray(a.presetAdsRaw))(new d.AdvertisementLoader).addPresetAds(a);else{for(var b=0,c=this.group.length;b<c;b++)if(this.group[b].checkRequestGroup(a)){this.group[b].interlockAdd(a);return}this.group[b]=new d.AdvertisementLoader;this.group[b].interlockAdd(a)}},unload:function(a){for(var b=0;b<this.group.length;b++)this.group[b]===a&&this.group.splice(b,1)}});d.Utility.extend(d.AdvertisementLoader.prototype,
{advertisements:null,timer:null,interval:0,isSend:!1,initialize:function(){if("undefined"===typeof e.loaderInterval)throw Error("Argument Ads.loaderInterval is required");var a=parseInt(e.loaderInterval,10);if(isNaN(a))throw Error("Argument Ads.loaderInterval must be numeric.");if(0>a)throw Error("Argument Ads.loaderInterval must be bigger than 0.");this.interval=a;this.advertisements=[]},add:function(a){if(this.isSend)return!1;this.advertisements.push(a);if(!this.timer){var b=this;this.timer=setTimeout(function(){b.isSend=
!0;b.send()},this.interval)}return!0},embedInterlockInfo:function(a,b,c){d.Utility.extend(a,b);a.zone=b.zoneIds[c];a.elementId=b.elementIds[c];a.template=b.templates[c];a.eventListener=b.eventListeners[c];null!==b.closeableActionElementIds[c]&&(a.closeableActionElementId=b.closeableActionElementIds[c]);a.closeableButtonText=null!==b.closeableButtonTexts[c]&&2===b.closeableButtonTexts[c].length?b.closeableButtonTexts[c]:["\u5e83\u544a\u3092\u9589\u3058\u308b","\u5e83\u544a\u3092\u8868\u793a"];a.forceLazyLoad=
b.forceLazyLoads[c]?b.forceLazyLoads[c]:!1;a.lazyLoadViewMargin=b.lazyLoadViewMargins[c]?b.lazyLoadViewMargins[c]:null;a.lazyLoadUrlName=b.lazyLoadUrlNames[c]?b.lazyLoadUrlNames[c]:null;a.viewImpThreshold=b.viewImpThresholds[c]?b.viewImpThresholds[c]:null;a.viewImpDelay=b.viewImpDelays[c]?b.viewImpDelays[c]:null},addPresetAds:function(a){var b={data:[]};if(Array.isArray(a.zoneIds)){for(var c=0,d=a.zoneIds.length;c<d;c++)if(Array.isArray(a.presetAds[c])&&a.presetAds[c].length&&(parseInt(a.zoneIds[c],
10)===parseInt(a.presetAds[c][0].zoneid,10)||parseInt(a.zoneIds[c],10)===parseInt(a.presetAds[c][0].chainid,10))){var e={};this.embedInterlockInfo(e,a,c);this.advertisements.push(e);b.data.push(a.presetAds[c][0])}this.callback(b)}else if(Array.isArray(a.presetAds)&&a.presetAds.length&&parseInt(a.zone,10)===parseInt(a.presetAds[0].zoneid,10)||parseInt(a.zone,10)===parseInt(a.presetAds[0].chainid,10))this.advertisements.push(a),b={data:[]},b.data.push(a.presetAds[0]),this.callback(b)},interlockAdd:function(a){for(var b=
0,c=a.zoneIds.length;b<c;b++){var d={};this.embedInterlockInfo(d,a,b);d.forceLazyLoad=a.forceLazyLoads[b]?a.forceLazyLoads[b]:!1;d.lazyLoadViewMargin=a.lazyLoadViewMargins[b]?a.lazyLoadViewMargins[b]:null;d.lazyLoadUrlName=a.lazyLoadUrlNames[b]?a.lazyLoadUrlNames[b]:null;this.add(d)}},checkRequestGroup:function(a){if(this.isSend)return!1;for(var b=0,c=this.advertisements.length;b<c;b++)if(d.Utility.hasIntersection(this.advertisements[b].zoneIds||[this.advertisements[b].zone],a.zoneIds||[a.zone]))return!1;
b=new d.AdvertisementAssembler(this.advertisements);a=new d.AdvertisementAssembler([a]);if(b.isAll()!==a.isAll()||null!==b.impression&&b.impression!==a.impression)return!1;if(0!==this.advertisements.length)if(d.Utility.count(b.segments)===d.Utility.count(a.segments))for(var e in b.segments){if(!a.segments[e]||a.segments[e]!==b.segments[e])return!1}else return!1;return!0},send:function(){this.timer=null;var a=new d.AdvertisementAssembler(this.advertisements),b=a.getZone(),c=a.segments,e=this;a.isAll()?
d.Api.getAllAdvertisements(b,c,function(a){e.callback(a)}):2===a.impression?d.Api.getAdvertisementsAndLogImpression(b,c,function(a){e.callback(a)}):d.Api.getAdvertisements(b,c,function(a){e.callback(a)})},callback:function(a){if(a.message)throw Error(a.message);for(var b=[],c=[],k=0;k<this.advertisements.length;k++){for(var f=this.advertisements[k],g=[],h=!0,l=0;l<a.data.length;l++)if(f.zone===parseInt(a.data[l].zoneid,10)||f.zone===parseInt(a.data[l].chainid,10))"nil"!==a.data[l].contenttype&&(h=
!1),f.zoneIds&&-1!==d.Utility.indexOf(f.zoneIds,f.zone)?(c.push(a.data[l]),b.push(f)):g.push(a.data[l]),a.data.splice(l--,1);null!==this.advertisements[k].eventListener&&((0<g.length||0<c.length)&&!1===h?"render"in this.advertisements[k].eventListener&&"function"===typeof this.advertisements[k].eventListener.render&&this.advertisements[k].eventListener.render():"empty"in this.advertisements[k].eventListener&&"function"===typeof this.advertisements[k].eventListener.empty&&this.advertisements[k].eventListener.empty());
0<g.length&&f.view.display(f,g)}0<c.length&&e.InterlockAds.display(b,c);d.AdvertisementLoader.unload(this)}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;d.Api=d.Class.create({count:0,prefix:"ads_callback",url:{OxBannerService:{getAdvertisements:"/api/OxBannerService/getAdvertisements.jsonp?",getAllAdvertisements:"/api/OxBannerService/getAllAdvertisements.jsonp?",getAdvertisementsAndLogImpression:"/api/OxBannerService/getAdvertisementsAndLogImpression.jsonp?",
logImpression:"/api/OxBannerService/logImpression.jsonp?",logViewableImpression:"/api/OxBannerService/logViewableImpression.json?",logEvent:"/api/OxBannerService/logEvent.jsonp?"}},getAdvertisements:function(a,b,c){var k=d.Utility.getPageUrl(e.pageUrl),f=d.Utility.getPageVariant();d.Utility.extend(b,{zone:a.join(","),pageurl:k,pagevariant:f,callback:this.setCallback(c)});this.loadScript(e.pathBase+this.url.OxBannerService.getAdvertisements,b)},getAllAdvertisements:function(a,b,c){var k=d.Utility.getPageUrl(e.pageUrl),
f=d.Utility.getPageVariant();d.Utility.extend(b,{zone:a.join(","),pageurl:k,pagevariant:f,callback:this.setCallback(c)});this.loadScript(e.pathBase+this.url.OxBannerService.getAllAdvertisements,b)},getAdvertisementsAndLogImpression:function(a,b,c){var k=d.Utility.getPageUrl(e.pageUrl),f=d.Utility.getPageVariant();d.Utility.extend(b,{zone:a.join(","),pageurl:k,pagevariant:f,callback:this.setCallback(function(a){if(Array.isArray(a.data))for(var b=0;b<a.data.length;b++)if(Array.isArray(a.data[b].imp_track_urls))for(var e=
0;e<a.data[b].imp_track_urls.length;e++)(new Image).src=d.Utility.replaceTimestampToRandomString(a.data[b].imp_track_urls[e]);c(a)})});this.loadScript(e.pathBase+this.url.OxBannerService.getAdvertisementsAndLogImpression,b)},logImpression:function(a,b,c,d){this.loadScript(e.pathBase+this.url.OxBannerService.logImpression,{campaignid:a,bannerid:b,zoneid:c,callback:this.setCallback(d)})},logViewableImpression:function(a,b,c,d){this.callApi(e.pathBase+this.url.OxBannerService.logViewableImpression,{campaignid:a,
bannerid:b,zoneid:c},d)},logEvent:function(a,b,c,d){this.loadScript(e.pathBase+this.url.OxBannerService.logEvent,{bannerid:a,zoneid:b,eventid:c,callback:this.setCallback(d)})},loadScript:function(a,b){var c=document.createElement("script");c.src=a+d.Utility.toQueryString(b)+"&_="+(new Date).getTime();c.type="text/javascript";c.charset="utf-8";e.removeLoadedSctipt&&(c.onload=c.onreadystatechange=function(){c.readyState&&"complete"!==c.readyState&&"loaded"!==c.readyState||(c.onload=c.onreadystatechange=
null,c.parentNode&&c.parentNode.removeChild(c),c=null)},c.onerror=c.onabort=function(){for(var a=0;a<d.AdvertisementLoader.group.length;a++)for(var b=0;b<d.AdvertisementLoader.group[a].advertisements.length;b++){var c=d.AdvertisementLoader.group[a].advertisements[b];null!==c.eventListener&&"empty"in c.eventListener&&"function"===typeof c.eventListener.empty&&c.eventListener.empty()}});document.getElementsByTagName("head")[0].appendChild(c)},setCallback:function(a){var b=d.Api.prefix+"_"+d.Api.count++;
window[b]=function(c){a(c);window[b]=void 0};return b},callApi:function(a,b,c){var e=new XMLHttpRequest;a=a+d.Utility.toQueryString(b)+"&_="+(new Date).getTime();e.open("GET",a,!0);e.withCredentials=!0;e.onload=function(a){c(JSON.parse(e.responseText))};e.onerror=function(a){throw Error("XMLHttpRequest\u3092\u4f7f\u3063\u305f\u30a2\u30af\u30bb\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f");};e.ontimeout=function(a){throw Error("\u30bf\u30a4\u30e0\u30a2\u30a6\u30c8\u304c\u767a\u751f\u3057\u307e\u3057\u305f");
};e.send()}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.Follow=d.Class.create({followBaseName:"ads_follow_",containers:{},locate:function(a,b){var c=d.Utility.getScroll();a=this.containers[a];a.top-a.margin<c.top?(a.bottom-a.follower.clientHeight-a.margin>c.top?(a.follower.style.position="fixed",a.follower.style.top=a.margin+"px"):(a.follower.style.position="absolute",a.follower.style.top=a.bottom-a.follower.clientHeight+"px"),a.follower.style.left=
b.left+"px"):(a.follower.style.position="static",b.top>a.top&&(a.top=b.top))},fix:function(a){var b=d.Utility.cumulativeOffset(this.containers[a].follower);e.Follow.locate(a,b)},resize:function(a){this.containers[a].follower.style.position="static";var b=d.Utility.cumulativeOffset(this.containers[a].follower);e.Follow.locate(a,b)},setMargin:function(a,b){this.containers[this.followBaseName+a]&&(this.containers[this.followBaseName+a].margin=b)},setBottom:function(a,b){this.containers[this.followBaseName+
a]&&(this.containers[this.followBaseName+a].bottom=b)}});d.Utility.extend(e.Follow.prototype,{initialize:function(a,b,c){var f=e.Follow.followBaseName+a,t=document.getElementById(a),g=d.Utility.cumulativeOffset(t);e.Follow.containers[f]={follower:t,margin:b||0,bottom:c||0,left:g.left,top:g.top};if(!e.Follow.containers[f].follower)throw Error(a+" is not found.");if(b&&"number"!==typeof b)throw Error("margin is not number.");if(c&&"number"!==typeof c)throw Error("bottom is not number.");d.Utility.addEvent(window,
"scroll",function(){e.Follow.fix(f)},!1);d.Utility.addEvent(window,"resize",function(){e.Follow.resize(f)},!1)}})})()},function(g,h){(function(){var f=(new Function("return this;"))().Ads.__internal__;f.Frequency=f.Class.create({domainPath:"domain=.nicovideo.jp; path=/;"});f.Utility.extend(f.Frequency.prototype,{initialize:function(){this.display=this.checked=!1},checkFrequency:function(e){this.checked||(0>e.views?this.display=!0:this.getFrequency(e.campaignid)<e.views&&(this.display=!0,this.logFrequency(e.campaignid)),
this.checked=!0);return this.display},getCampaigns:function(){for(var e=document.cookie.split(";"),d=e.length,a=0;a<d;a++)if(e[a].match(/^\s*nicoads_fc/))return f.Utility.deleteEmptyFromArray(e[a].replace(/^\s*nicoads_fc=/,"").split("|"));return[]},getFrequency:function(e){for(var d=this.getCampaigns(),a=d.length,b=0;b<a;b++)if(d[b].match("^"+e+"="))return d[b].split("=")[1]-0;return 0},logFrequency:function(e){var d=this.getFrequency(e)+1,a=new Date;a.setDate(a.getDate()+1);a.setHours(0);a.setMinutes(0);
a.setSeconds(0);for(var b=this.getCampaigns(),c=b.length,k=0;k<c;k++)if(b[k].match("^"+e+"=")){b.splice(k,1);break}b.push(e+"="+d);document.cookie="nicoads_fc="+b.join("|")+"; "+f.Frequency.domainPath+"; expires="+a.toGMTString()}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.InterlockAds=d.Class.create({display:function(a,b){var c;if(!d.Utility.canPlayMp4()){var f=0;for(c=b.length;f<c;f++)if("mp4"==b[f].contenttype)return}f=e.InterlockAds.categorizeAdvertisement(a,
b);a=f.stdAds;b=f.sidewallAds;for(f=a.length-1;0<=f;f--)a.instances[f].view.display(a.instances[f],[a.adData[f]]);2===b.adData.length&&(e.Sidewall.setAdjust(),e.Sidewall.callback({data:b.adData}))},categorizeAdvertisement:function(a,b){for(var c={stdAds:{instances:[],adData:[],length:0},sidewallAds:{instances:[],adData:[],length:0}},e=0,f=b.length;e<f;e++)a[e].sidewall&&-1!==d.Utility.indexOf(a[e].sidewall,a[e].zone)?(c.sidewallAds.instances.push(a[e]),c.sidewallAds.adData.push(b[e]),c.sidewallAds.length++):
(c.stdAds.instances.push(a[e]),c.stdAds.adData.push(b[e]),c.stdAds.length++);return c}});d.Utility.extend(e.InterlockAds.prototype,{initialize:function(a){this.elementId=this.zone=null;this.zoneIds=[];this.elementIds=[];this.templates=[];this.eventListeners=[];this.sidewall=[];this.sidewallElementIds=[];this.closeableActionElementIds=[];this.closeableButtonTexts=[];this.forceLazyLoads=[];this.lazyLoadViewMargins=[];this.lazyLoadUrlNames=[];this.viewImpThresholds=[];this.viewImpDelays=[];this.count=
1;this.hasAssignAd=null;this.view=new e.View;this.time=(new Date).getTime()+Math.floor(1E6*Math.random());this.advertisements=a.advertisements||[];this.presetAdsRaw=(new d.PresetAdvertisementSet(a.presetAds)).getPresetAds();this.presetAds=[];this.segments=a.segments||{};this.impression="number"===typeof a.impression?a.impression:1;this.contentsWidth="number"===typeof a.contentsWidth?a.contentsWidth:0;this.activatesAdjust="boolean"===typeof a.activatesAdjust?a.activatesAdjust:!0;for(a=0;a<this.advertisements.length;a++)if("eventListeners"in
this.advertisements[a]&&"render"in this.advertisements[a].eventListeners&&"function"!==typeof this.advertisements[a].eventListeners.render)throw Error("render must be a function.");for(a=0;a<this.advertisements.length;a++)if("eventListeners"in this.advertisements[a]&&"empty"in this.advertisements[a].eventListeners&&"function"!==typeof this.advertisements[a].eventListeners.empty)throw Error("empty must be a function.");if(Array.isArray(this.presetAdsRaw)){var b=this.presetAdsRaw.concat();for(a=0;a<
this.advertisements.length;a++){this.advertisements[a].presetAds=[];for(var c=0;c<b.length;c++)if(parseInt(b[c].zoneid,10)===parseInt(this.advertisements[a].zoneId,10)||parseInt(b[c].chainid,10)===parseInt(this.advertisements[a].zoneId,10)){this.advertisements[a].presetAds.push(b[c]);b.splice(c,1);break}}}for(a=0;a<this.advertisements.length;a++)this.zoneIds.push(this.advertisements[a].zoneId),this.elementIds.push(this.advertisements[a].elementId),this.templates.push(this.advertisements[a].template),
"eventListeners"in this.advertisements[a]?this.eventListeners.push(this.advertisements[a].eventListeners):this.eventListeners.push(null),this.advertisements[a].hasOwnProperty("sidewall")&&this.advertisements[a].sidewall&&(this.sidewall.push(this.advertisements[a].zoneId),this.sidewallElementIds.push(this.advertisements[a].elementId)),this.presetAds.push(Array.isArray(this.advertisements[a].presetAds)?this.advertisements[a].presetAds:null),this.closeableActionElementIds.push("undefined"!==typeof this.advertisements[a].closeableActionElementId?
this.advertisements[a].closeableActionElementId:null),this.closeableButtonTexts.push("undefined"!==typeof this.advertisements[a].closeableButtonText?this.advertisements[a].closeableButtonText:null),this.forceLazyLoads.push("undefined"!==typeof this.advertisements[a].forceLazyLoad?this.advertisements[a].forceLazyLoad:!1),this.lazyLoadViewMargins.push("undefined"!==typeof this.advertisements[a].lazyLoadViewMargin?this.advertisements[a].lazyLoadViewMargin:null),this.lazyLoadUrlNames.push("undefined"!==
typeof this.advertisements[a].lazyLoadUrlName?this.advertisements[a].lazyLoadUrlName:null),this.viewImpThresholds.push("undefined"!==typeof this.advertisements[a].viewImpThreshold?this.advertisements[a].viewImpThreshold:null),this.viewImpDelays.push("undefined"!==typeof this.advertisements[a].viewImpDelay?this.advertisements[a].viewImpDelay:null);2===this.sidewall.length&&2===this.sidewallElementIds.length&&e.Sidewall.setParameters({zoneIds:this.sidewall,locations:this.sidewallElementIds,contentsWidth:this.contentsWidth,
segments:this.segments,impression:this.impression,activatesAdjust:this.activatesAdjust,time:this.time})},set:function(){d.AdvertisementLoader.registers(this)},getElement:function(){return document.getElementById(this.elementId)}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.Sidewall=d.Class.create({EVENT_SET_DEFERRED_TIMER:"SET_DEFERRED_TIMER",EVENT_INVOKE_VIEW_DISPLAY:"INVOKE_VIEW_DISPLAY",callbackName:"ads_sidewall_callback",zoneIds:null,
elementIds:null,adContainers:[],adContainerWidth:0,adContainerHeight:0,count:1,isInterlock:!0,view:null,segments:null,impression:null,activatesAdjust:null,contentsWidth:0,margin:0,eventListener:null,presetAds:null,deferredSettings:{active:!1,deferredTimes:[],marginTimeBefore:300,marginTimeAfter:300,randomCoefficient:240,useDeferredTimeRange:{start:"20:00",end:"23:59"},deferredProbability:.5},setParameters:function(a){this.adContainerHeight=this.adContainerWidth=0;this.zoneIds=[].concat(a.zoneIds||
[]);this.elementIds=[].concat(a.locations||[]);if(2!==this.zoneIds.length||2!==this.elementIds.length)throw Error("zoneIds and locations need both left and right.");this.impression="number"===typeof a.impression?a.impression:1;this.segments=a.segments||{};this.activatesAdjust="boolean"===typeof a.activatesAdjust?a.activatesAdjust:!0;this.adContainers=[document.getElementById(this.elementIds[0]),document.getElementById(this.elementIds[1])];this.contentsWidth=a.contentsWidth;this.margin=a.margin||0;
this.eventListener=a.eventListeners||null;this.presetAds=a.presetAds||null;this.viewImpThreshold="number"===typeof a.viewImpThreshold?a.viewImpThreshold:null;this.viewImpDelay="number"===typeof a.viewImpDelay?a.viewImpDelay:null;if(null!==this.presetAds){var b=[];try{b=JSON.parse(this.presetAds)}catch(u){throw Error("invalid json format.");}if(2!=b.length)throw Error("The left and right zone presetAds arguments must be specified at the same time.");}if("object"===typeof a.deferredSettings){b=a.deferredSettings;
"boolean"===typeof b.active&&(this.deferredSettings.active=b.active);"number"===typeof b.marginTimeBefore&&(this.deferredSettings.marginTimeBefore=b.marginTimeBefore);"number"===typeof b.marginTimeAfter&&(this.deferredSettings.marginTimeAfter=b.marginTimeAfter);"number"===typeof b.randomCoefficient&&(this.deferredSettings.randomCoefficient=b.randomCoefficient);for(var c=[].concat(b.deferredTimes||[]),d=0,f=c.length;d<f;d++)if("object"===typeof c[d]&&"number"===typeof c[d].time&&"string"===typeof c[d].id)this.deferredSettings.deferredTimes.push(c[d]);
else throw Error("Argument deferredTimes must be object. Argument deferredTimes[].time must be number. Argument deferredTimes[].id must be string.");if("object"===typeof b.useDeferredTimeRange){c=b.useDeferredTimeRange;if("string"===typeof c.start&&null!==c.start.match(/^[0-2][0-9]:[0-5][0-9]$/)&&"24:00">c.start)this.deferredSettings.useDeferredTimeRange.start=c.start;else throw Error('Argument useDeferredTimeRange.start must be match this pattern "^[0-2][0-9]:[0-5][0-9]$".');if("string"===typeof c.end&&
null!==c.end.match(/^[0-2][0-9]:[0-5][0-9]$/)&&"24:00">c.end)this.deferredSettings.useDeferredTimeRange.end=c.end;else throw Error('Argument useDeferredTimeRange.end must be match this pattern "^[0-2][0-9]:[0-5][0-9]$".');}if("number"===typeof b.deferredProbability)if(0<b.deferredProbability&&1>=b.deferredProbability)this.deferredSettings.deferredProbability=b.deferredProbability;else throw Error("Argument deferredProbability must be more than 0");}if(this.deferredSettings.useDeferredTimeRange.start===
this.deferredSettings.useDeferredTimeRange.end)throw Error("Argument useDeferredTimeRange.start and useDeferredTimeRange.end must be set to a different value. If want to enable all day, please set useDeferredTimeRange {'00:00','23:59'}");this.count="number"===typeof a.count?a.count:1;this.view=a.view&&a.view.display?a.view:new e.SidewallView;if(this.count!==e.ALL&&1!==this.count)throw Error("Argument count must be numeric 1 or Ads.ALL(-1).");if(this.count===e.ALL&&2===this.impression)throw Error("You can not set [count: ALL] and [impression: 2] at a time.");
},adjust:function(){e.Sidewall.adContainers[0].style.width=0;e.Sidewall.adContainers[1].style.width=0;var a=Math.max(document.documentElement.clientWidth,document.body.clientWidth)-e.Sidewall.contentsWidth;if(!(0>=a)){a=Math.floor(a/2);a=a>e.Sidewall.adContainerWidth?e.Sidewall.adContainerWidth:a;var b=a+e.Sidewall.margin;e.Sidewall.adContainers[0].style.display="block";e.Sidewall.adContainers[0].style.width=a+"px";e.Sidewall.adContainers[0].style.left=-b+"px";e.Sidewall.adContainers[1].style.display=
"block";e.Sidewall.adContainers[1].style.width=a+"px";e.Sidewall.adContainers[1].style.right=-b+"px"}},setAdjust:function(){e.Sidewall.activatesAdjust&&(d.Utility.addEvent(window,"resize",e.Sidewall.adjust),e.Sidewall.adjust())},invoke:function(){this.setAdjust();window[this.callbackName]=e.Sidewall.callback;var a=d.Utility.getPageUrl(e.pageUrl),b=d.Utility.getPageVariant();a={zone:this.zoneIds.join(","),pageurl:a,pagevariant:b,callback:this.callbackName};if(null!==this.eventListener){if("render"in
this.eventListener&&"function"!==typeof this.eventListener.render)throw Error("render must be a function.");if("empty"in this.eventListener&&"function"!==typeof this.eventListener.empty)throw Error("empty must be a function.");}d.Utility.extend(a,this.segments);if(null===e.Sidewall.presetAds)this.count===e.ALL?d.Api.loadScript(e.pathBase+d.Api.url.OxBannerService.getAllAdvertisements,a):2===this.impression?d.Api.loadScript(e.pathBase+d.Api.url.OxBannerService.getAdvertisementsAndLogImpression,a):
d.Api.loadScript(e.pathBase+d.Api.url.OxBannerService.getAdvertisements,a);else{a={};a.data=JSON.parse(e.Sidewall.presetAds);if(2===this.impression){var c=this;for(b=0;b<a.data.length;b++)if(d.Api.logImpression(a.data[b].campaignid,a.data[b].bannerid,a.data[b].zoneid,function(a){c.logImpressionCallback(a)}),Array.isArray(a.data[b].imp_track_urls))for(var f=0;f<a.data[b].imp_track_urls.length;f++)(new Image).src=d.Utility.replaceTimestampToRandomString(a.data[b].imp_track_urls[f])}e.Sidewall.callback(a)}},
setMaxWidth:function(a){for(var b=0,c=0,d=a.length;c<d;c++)parseInt(a[c].width||0,10)>b&&(b=parseInt(a[c].width,10));0<b&&(this.adContainerWidth=b)},setMaxHeight:function(a){for(var b=0,c=0,d=a.length;c<d;c++)parseInt(a[c].height||0,10)>b&&(b=parseInt(a[c].height,10));0<b&&(this.adContainerHeight=b)},callback:function(a){var b=a.data;if(0!==b.length&&0===b.length%2){e.Sidewall.setMaxWidth(b);e.Sidewall.setMaxHeight(b);e.Sidewall.activatesAdjust&&e.Sidewall.adjust();var c=b.splice(0,b.length/2),f=
[],g=d.Utility.map(b,function(a){return a.interlock_campaign_id}),h=d.Utility.map(c,function(a){return a.campaignid}),p=[];for(a=0;a<h.length;a++)-1===d.Utility.indexOf(g,h[a])&&p.push(h[a]);h=[];var l=0;for(g=c.length;l<g;l++)h[c[l].campaignid]=l;for(a in b)if(0==b[a].interlock_campaign_id)g=p.shift(),f.push(c[h[g]]);else for(l=0,g=c.length;l<g;l++)if(b[a].interlock_campaign_id==c[l].campaignid){f.push(c[l]);break}var r={left:e.Sidewall.getExtendedSidewall(0),right:e.Sidewall.getExtendedSidewall(1)};
a=[f,b];g=!0;for(c=0;2>c;c++)if("nil"!==a[c].contenttype){g=!1;break}null!==e.Sidewall.eventListener&&(!1===g?"render"in e.Sidewall.eventListener&&"function"===typeof e.Sidewall.eventListener.render&&e.Sidewall.eventListener.render():"empty"in e.Sidewall.eventListener&&"function"===typeof e.Sidewall.eventListener.empty&&e.Sidewall.eventListener.empty());var m={left:f,right:b};b=e.Sidewall.deferredSettings;a=new Date;a=(10>a.getHours()?"0"+a.getHours():a.getHours())+":"+(10>a.getMinutes()?"0"+a.getMinutes():
a.getMinutes());g=b.useDeferredTimeRange;f=!1;if(g.end<g.start){if(g.start<=a||a<=g.end)f=!0}else g.start<=a&&a<=g.end&&(f=!0);if(b.active&&f){f=b.deferredTimes;c=!1;a=0;for(g=f.length;a<g;a++){var n="number"===typeof f[a].randomCoefficient?f[a].randomCoefficient:b.randomCoefficient;p="number"==typeof f[a].deferredProbability&&0<f[a].deferredProbability&&1>=f[a].deferredProbability?f[a].deferredProbability:b.deferredProbability;h=f[a].time-("number"===typeof f[a].marginTimeBefore?f[a].marginTimeBefore:
b.marginTimeBefore);l=f[a].time+("number"===typeof f[a].marginTimeAfter?f[a].marginTimeAfter:b.marginTimeAfter);var q=(new Date).getTime()/1E3;n=Math.random()*n*1E3;if(h<=q&&q<l&&Math.random()<p){e.Sidewall.fireEvent(e.Sidewall.EVENT_SET_DEFERRED_TIMER,n);setTimeout(function(){e.Sidewall.fireEvent(e.Sidewall.EVENT_INVOKE_VIEW_DISPLAY);e.Sidewall.view.display(r,m)},n);c=!0;break}}c||(e.Sidewall.fireEvent(e.Sidewall.EVENT_INVOKE_VIEW_DISPLAY),e.Sidewall.view.display(r,m))}else e.Sidewall.fireEvent(e.Sidewall.EVENT_INVOKE_VIEW_DISPLAY),
e.Sidewall.view.display(r,m)}},getExtendedSidewall:function(a){var b={};d.Utility.extend(b,this);d.Utility.extend(b,{getElement:function(){return b.adContainers[a]}});return b},logImpressionCallback:function(a){if(a.message)throw Error(a.message);}});d.Class.mixin(e.Sidewall,d.Event)})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.SidewallSwitchView=d.Class.create();d.Utility.extend(e.SidewallSwitchView.prototype,{switchViewLeft:null,switchViewRight:null,
interval:0,second:0,responseLength:0,index:0,switchAdIntervalID:0,ignoreScreen:!1,ignoreFocus:!1,wasActive:!0,useWeightRotation:!1,initialize:function(a){if(a&&"number"!==typeof a)throw Error("interval is not number.");if(0>a)throw Error("The interval must be greater than or equal to 0.");this.interval=a||30},setIgnoreScreen:function(){this.ignoreScreen=!0;return this},setIgnoreFocus:function(){this.ignoreFocus=!0;return this},display:function(a,b){if(a.left&&a.right&&b.left&&b.right&&b.left.length===
b.right.length){this.responseLength=b.left.length;for(var c=0;c<this.responseLength;c++)if(null===b.left[c].rotation_priority){this.useWeightRotation=!0;break}this.switchViewLeft=new d.SidewallSwitchViewChild(a.left,b.left);this.switchViewRight=new d.SidewallSwitchViewChild(a.right,b.right);this.show();this.startSwitchAdTimer()}},startSwitchAdTimer:function(){var a=this;this.switchAdIntervalID=setInterval(function(){a.switchAdTimerHandler()},1E3)},switchAdTimerHandler:function(){this.switchViewLeft.isZombie()||
this.switchViewRight.isZombie()?(this.stopSwitchAdTimer(),this.switchViewLeft.destroy(),this.switchViewRight.destroy()):this.isActive()&&this.second++>=this.interval&&this.switchNext()},stopSwitchAdTimer:function(){clearInterval(this.switchAdIntervalID)},isActive:function(){return(this.switchViewLeft.isScreen()&&this.switchViewRight.isScreen()||this.ignoreScreen)&&(d.Utility.hasFocus()||this.ignoreFocus)?!0:!1},switchNext:function(){var a=this;a.second=0;setTimeout(function(){a.show()},500)},show:function(){this.switchViewLeft.showAd(this.index);
this.switchViewRight.showAd(this.index);this.useWeightRotation?this.updateIndexForWeightRotation():this.updateIndexForSequentialRotation()},updateIndexForSequentialRotation:function(){this.index++;this.index%=this.responseLength},updateIndexForWeightRotation:function(){for(var a=this.switchViewLeft.responses,b=0,c=0;c<a.length;c++)b+=a[c].weight;b*=Math.random();var d=0;for(c=0;c<a.length;c++)if(d+=a[c].weight,b<d){this.index=c;return}this.index=a.length-1}})})()},function(g,h){(function(){var f=
(new Function("return this;"))(),e=f.Ads.__internal__;e.SidewallSwitchViewChild=e.Class.create();e.Utility.extend(e.SidewallSwitchViewChild.prototype,{advertisement:null,responses:null,canvas:null,template:null,initialize:function(d,a){1>a.length||(this.advertisement=d,this.responses=a,this.canvas=document.createElement("div"),this.canvas.id=this.advertisement.getElement().id+"_child",this.advertisement.getElement().appendChild(this.canvas))},initCanvas:function(d){d.getWidth()&&d.getHeight()&&(this.canvas.style.width=
d.getWidth()+"px",this.canvas.style.height=d.getHeight()+"px");this.canvas.innerHTML=""},showAd:function(d){if("number"===typeof d&&!(d>this.responses.length-1)&&(d=this.responses[d],this.template=new e.Template(this.advertisement,d),this.initCanvas(this.template),e.Utility.updateElement(this.canvas,this.template.getString()))){if(1===this.advertisement.impression&&(e.Api.logImpression(d.campaignid,d.bannerid,d.zoneid,this.logimpressionCallback),Array.isArray(d.imp_track_urls)))for(var a=0;a<d.imp_track_urls.length;a++)(new Image).src=
e.Utility.replaceTimestampToRandomString(d.imp_track_urls[a]);if(3===this.advertisement.impression||1===this.advertisement.impression){a=this.advertisement.viewImpThreshold||.5;var b=this.advertisement.viewImpDelay||1E3,c=this.advertisement.getElement().querySelectorAll("img, iframe");e.Utility.observationViewableImpression(c,d.campaignid,d.bannerid,d.zoneid,this.logimpressionCallback,a,b)}d.optional&&(document.body.style.backgroundColor=d.optional)}},isScreen:function(){var d=this.advertisement.getElement();
if("fixed"===(d.currentStyle||f.getComputedStyle(d,null)).position)return!0;d=e.Utility.getScroll();var a=e.Utility.isBackCompat?{width:document.body.clientWidth||window.innerWidth,height:document.body.clientHeight||window.innerHeight}:{width:document.documentElement.clientWidth||window.innerWidth,height:document.documentElement.clientHeight||window.innerHeight},b=this.canvas;if(!this.advertisement.activatesAdjust&&a.width<=this.advertisement.contentsWidth)return!1;var c=b.currentStyle||f.document.defaultView.getComputedStyle(b,
null);if(c.position&&"fixed"===c.position)return!0;c=this.advertisement.getElement();c=c.currentStyle||f.document.defaultView.getComputedStyle(c,null);if(c.position&&"fixed"===c.position)return!0;var g=b,h=c=0;do c+=g.offsetTop||0,h+=g.offsetLeft||0;while(g=g.offsetParent);g=h+b.offsetWidth;b=c+b.offsetHeight;return 0===this.advertisement.getElement().clientWidth||g<=d.left||b<=d.top||h>=a.width+d.left||c>=a.height+d.top?!1:!0},logimpressionCallback:function(d){if(!d.success&&d.message)throw Error(d.message);
},isZombie:function(){var d=this.canvas;do if("BODY"===d.nodeName)return!1;while(d=d.parentNode);return!0},destroy:function(){this.canvas.innerHTML="";this.canvas=null}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.SidewallView=d.Class.create();d.Utility.extend(e.SidewallView.prototype,{frequency:null,initialize:function(){this.frequency=new d.Frequency},display:function(a,b){a.left&&a.right&&b.left&&b.right&&b.left.length===b.right.length&&
(this.setAd(a.left,b.left[0]),this.setAd(a.right,b.right[0]))},setAd:function(a,b){if(this.frequency.checkFrequency(b)&&d.Utility.updateElement(a.getElement(),(new d.Template(a,b)).getString())){if(1===a.impression&&(d.Api.logImpression(b.campaignid,b.bannerid,b.zoneid,this.logimpressionCallback),Array.isArray(b.imp_track_urls)))for(var c=0;c<b.imp_track_urls.length;c++)(new Image).src=d.Utility.replaceTimestampToRandomString(b.imp_track_urls[c]);if(3===a.impression||1===a.impression){c=a.viewImpThreshold||
.5;var e=a.viewImpDelay||1E3;a=a.getElement().querySelectorAll("img, iframe");d.Utility.observationViewableImpression(a,b.campaignid,b.bannerid,b.zoneid,this.logimpressionCallback,c,e)}b.optional&&(document.body.style.backgroundColor=b.optional)}},logimpressionCallback:function(a){if(!a.success&&a.message)throw Error(a.message);}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.SwitchView=d.Class.create();d.Class.mixin(e.SwitchView.prototype,d.Event);
d.Utility.extend(e.SwitchView.prototype,{EVENT_AD_VISIBLE:"EVENT_VISIBLE_AD",EVENT_AD_INVISIBLE:"EVENT_INVISIBLE_AD",advertisement:null,responses:null,index:0,second:0,interval:0,canvas:null,prevVisibility:!0,ignoreScreen:!1,ignoreFocus:!1,backgroundColor:null,switchAdIntervalID:0,activeVisibilityEvent:!1,eVisible:!0,useWeightRotation:!1,_io:null,_isScreen:!1,initialize:function(a,b){function c(a,b){b=!0;for(var c=0;c<a.length;c++)a[c].isIntersecting||(b=!1);d._isScreen=b}if(a&&"number"!==typeof a)throw Error("interval is not number.");
this.interval=a||30;this.backgroundColor="string"===typeof b?b:"#efefef";this.addListener(this.EVENT_AD_VISIBLE,function(){this.eVisible=!0},this);this.addListener(this.EVENT_AD_INVISIBLE,function(){this.eVisible=!1},this);var d=this;this._io=e.__internal__.Polyfill.isIntersectionObserverPolyfill?new e.__internal__.Polyfill.IntersectionObserver(c,{}):new IntersectionObserver(c,{})},setIgnoreScreen:function(){this.ignoreScreen=!0;return this},setIgnoreFocus:function(){this.ignoreFocus=!0;return this},
setActiveVisibilityEvent:function(){this.activeVisibilityEvent=!0;return this},display:function(a,b){this.setting(a,b);for(a=0;a<b.length;a++)if(null===b[a].rotation_priority){this.useWeightRotation=!0;break}var c=this;this.switchAdIntervalID=setInterval(function(){c.isZombie()?c.destroy():c.isActive()&&c.switchNext()},1E3)},stopSwitchAdTimer:function(){clearInterval(this.switchAdIntervalID)},setting:function(a,b){this.advertisement=a;this.responses=b;void 0!==this.advertisement.getElement()&&null!==
this.advertisement.getElement()&&(this.canvas=document.createElement("div"),this.advertisement.getElement().appendChild(this.canvas),a=this.getNextResponse(),this.initCanvas(a),this.show(a),this._io.observe(this.canvas))},getNextResponse:function(){return this.useWeightRotation?this.getWeightRotationResponse():this.getSequentialRotationResponse()},getSequentialRotationResponse:function(){var a=this.index;this.index++;this.index%=this.responses.length;return this.responses[a]},getWeightRotationResponse:function(){for(var a=
0,b=0;b<this.responses.length;b++)a+=this.responses[b].weight;a*=Math.random();var c=0;this.index=b-1;for(b=0;b<this.responses.length;b++)if(c+=this.responses[b].weight,a<c){this.index=b;break}return this.responses[this.index]},switchNext:function(){var a=this.getNextResponse();this.initCanvas(a);var b=this;setTimeout(function(){b.show(a);b.second=0},500)},initCanvas:function(a){a=new d.Template(this.advertisement,a);a.getWidth()&&a.getHeight()&&(this.canvas.style.width=a.getWidth()+"px",this.canvas.style.height=
a.getHeight()+"px");a.isText()||(this.canvas.style.backgroundColor=this.backgroundColor);this.canvas.innerHTML=""},show:function(a){this.canvas.innerHTML=(new d.Template(this.advertisement,a)).getString();if(1===this.advertisement.impression&&(d.Api.logImpression(a.campaignid,a.bannerid,a.zoneid,this.logimpressionCallback),Array.isArray(a.imp_track_urls)))for(var b=0;b<a.imp_track_urls.length;b++)(new Image).src=d.Utility.replaceTimestampToRandomString(a.imp_track_urls[b]);if(3===this.advertisement.impression||
1===this.advertisement.impression){b=this.advertisement.viewImpThreshold||.5;var c=this.advertisement.viewImpDelay||1E3,e=this.advertisement.getElement().querySelectorAll("img, iframe");d.Utility.observationViewableImpression(e,a.campaignid,a.bannerid,a.zoneid,this.logimpressionCallback,b,c)}},isActive:function(){var a=this.activeVisibilityEvent?this.eVisible:this.isScreen()&&(d.Utility.hasFocus()||this.ignoreFocus);return this.prevVisibility!==a&&(this.prevVisibility=a)?!0:this.prevVisibility&&this.isIntervalPass()},
isIntervalPass:function(){return this.second<this.interval?(this.second++,!1):!0},isScreen:function(){if(this.ignoreScreen)return!0;var a=this.canvas;if(!a)return!1;for(;a.parentNode;a=a.parentNode)if("none"===a.style.display)return!1;return this._isScreen},logimpressionCallback:function(a){if(!a.success&&a.message)throw Error(a.message);},isZombie:function(){var a=this.canvas;do if("BODY"===a.nodeName)return!1;while(a=a.parentNode);return!0},destroy:function(){this.stopSwitchAdTimer();this._io.unobserve(this.canvas);
this.canvas.innerHTML="";this.canvas=null}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;d.Template=d.Class.create();d.Utility.extend(d.Template.prototype,{advertisement:null,response:null,videoTagId:null,lazyLoadUrlName:null,ICON_SPEAKER_ON:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAACnVBMVEUAAAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8NDQ3e3t4TExNfX18PDw9bW1sJCQl7e3sHBwdmZmbz8/NZWVnu7u5hYWHLy8vY2NjCwsK5ubkQEBD8/PwRERFsbGxOTk4yMjLt7e1EREQODg7s7Oz6+vogICBAQECPj49BQUEWFha6urrFxcXk5OSTk5OcnJxycnLh4eEFBQWenp5zc3Ojo6PQ0NAhISHMzMzGxsZubm4CAgLc3NyhoaF3d3fKyso+Pj6Kiori4uK4uLioqKgsLCxgYGD29vYnJyfm5ua7u7scHBy/v785OTltbW3r6+tISEiZmZkGBgbn5+dDQ0OqqqqkpKRSUlKzs7NwcHB0dHQjIyOVlZV5eXl6enqWlpaRkZGMjIzX19eBgYGysrKamprb29tPT08SEhL7+/t9fX0uLi41NTVXV1dJSUkMDAxvb29CQkLAwMD19fV4eHgrKyvT09MBAQHNzc28VjmZAAAAbnRSTlMAAOSWuVl4wrh1X5NbUrp9DQlzYUEDdw9yb9jehScQUAZiI/NCNUgyLMWeflyVQCjtqhIHipEhmRSjuzlmdMZODldgzSAYsy2ywD7QzNyhbGN7y4Koj0R5P+xWv20EnJI7pNea2xFuMS5JDCvTahiHXUUAAAHmSURBVHhetZJVbxtBFIWvu7ZTQxuuQw0zl5mZmZn5mCnMzJwiMzMzMzP8lnpXq3RXae2X5Hs60vmkuXNnSOIC6jz693Uf6Kz3NB956+5MiD1hP6OXkZiYYD54jBg56gOQ7eYrrMcxRbn+XJqgLSz1ajkEFKgEfVT8M2QFcJF5hP3TvPV5yMvv3dYnxrUC9gjy9OuX4hBwZYDKAliC2C5aqVTKtXUA6rsQ0/RYGlJ6DXjvk1qMdGsfIuaywWCwNYMTep4GcqQJ14EbvZLuA5XJNNQGHlbQGB3mq7BAHcr1kV+A73Ia81sokLwCyJytuAPc6varGDsGkTRHJNDgszhlHnIBuDts+B7Udqeux8TC6JPAubEVwMEe42875mkneGc4hPB7rDDx+b+ESV/xzTz5MLDdyy2bPWLKTpGg2AXsnuq/lx1yXxkOTKcZBUIhOFcHFM4MyEJ5DXtNyyzyZUpMJlPGUeGi5pQAx+fOqwKqfYhovlqtXqA9z6867aI0xHgJKFq4qAzpV0OJZ/GSm9xjkWzpMlUD0Lh8xQPgYRC1sXLVEzxdzcU1L/BybdjrN0D+OvpLOPPOuJ5LG7QfP/lZM4HPDInYqOGDx6bNsjT2y4XSf9nyQ/fTKCMnKAK3bqOOQeICl8IfIP/SmuHJo30AAAAASUVORK5CYII=",
ICON_SPEAKER_OFF:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAABAlBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD///8QEBDQ0NBaWlpgYGCAgICgoKBAQEBhYWEgICAwMDDFxcVwcHCenp6EhIQ/Pz/r6+vZ2dlnZ2fNzc3AwMBQUFBtbW1YWFjw8PCmpqa6uroCAgIMDAzKysq5ubnPz8+rq6vb29vOzs5LS0vk5ORsbGwVFRVkZGR/jn2TAAAALnRSTlMA0GeWQCAQYWSgnlq5MDc1YMUbgFfZBMBYbVCmz81cus5sA0t7Pz2Ch8rbcEKr9f/MZwAAAQZJREFUeF7dktduwzAMRRnZsZO4aZ107r0H5Z2d7r3X//9KSVcQ4MJ133NfdKFzIFCCYNQyUZsr5M1a76pSwHcW+3i2/DdfadwgnkxTMyddiwCX8g/btG17666DiF6JeBwGUgBMzcZhi40Z4y1JktN3VMLCBa1SCHmOGJskzF+iDgv1NhcpPVTC0lNWACPg5qUaDzP2mBWUkXIBuQIYXeYR8XxBSE8fQFm9zQiaa2Pt9ZdQYh6F+sD1j5xrRtV00nadhA1j4Pt+MET9kszH6S7XGLjA2XYcZ/f+QQmWjFvEAfZkl55ax95/Rnw5ADJMtW0dctE5Ou5jp1H4YT57X5V/vhzxEc03xdE37fNwkdEAAAAASUVORK5CYII=",
OPERA_PRE_PROPERTY:"-o-",MOZILLA_PRE_PROPERTY:"-moz-",CHROME_PRE_PROPERTY:"-webkit-",TRANSITION_PROPERTY:"transition-property",TRANSITION_DURATION:"transition-duration",TRANSITION_TIMING_FUNCTION:"transition-timing-function",CLOSEABLE_TRANSITION_PROPERTY:"height",CLOSEABLE_TRANSITION_DURATION:"400ms",CLOSEABLE_TRANSITION_TIMING_FUNCTION:"ease-in-out",initialize:function(a,b){this.advertisement=a;this.response=b;this.advertisement.closeableActionElementId&&(null!==this.advertisement.presetAds?this.setTransitionStyles(!1):
this.setTransitionStyles(!0))},setTransitionStyles:function(a){var b=document.getElementById(this.advertisement.elementId);b.style.width=this.getWidth()+"px";a&&(b.style.height="0px");b.style.overflow="hidden";a="";"undefined"!==typeof b.style[this.OPERA_PRE_PROPERTY+this.TRANSITION_PROPERTY]?a=this.OPERA_PRE_PROPERTY:"undefined"!==typeof b.style[this.CHROME_PRE_PROPERTY+this.TRANSITION_PROPERTY]?a=this.CHROME_PRE_PROPERTY:"undefined"!==typeof b.style[this.MOZILLA_PRE_PROPERTY+this.TRANSITION_PROPERTY]&&
(a=this.MOZILLA_PRE_PROPERTY);""!==a&&(b.style[a+this.TRANSITION_PROPERTY]=this.CLOSEABLE_TRANSITION_PROPERTY,b.style[a+this.TRANSITION_DURATION]=this.CLOSEABLE_TRANSITION_DURATION,b.style[a+this.TRANSITION_TIMING_FUNCTION]=this.CLOSEABLE_TRANSITION_TIMING_FUNCTION);"undefined"!==typeof b.style[this.TRANSITION_PROPERTY]&&(b.style[this.TRANSITION_PROPERTY]=this.CLOSEABLE_TRANSITION_PROPERTY,b.style[this.TRANSITION_DURATION]=this.CLOSEABLE_TRANSITION_DURATION,b.style[this.TRANSITION_TIMING_FUNCTION]=
this.CLOSEABLE_TRANSITION_TIMING_FUNCTION);var c=this;setTimeout(function(){b.style.height=c.getHeight()+"px"},20)},getTag:function(){var a=null;if(this.isVideo()&&d.Utility.canPlayMp4()){if(this.videoTagId="ads_video_id_"+this.getRandomId(),navigator&&navigator.userAgent){var b='<div style="position: relative; width: '+this.getWidth()+"px; height: "+this.getHeight()+'px; background-color: #000; margin-left: auto; margin-right: auto;">';a='<img id="img_'+this.videoTagId+'" style="position:absolute; display:block; bottom:-5px; left:1px; z-index:10;" src="'+
this.ICON_SPEAKER_OFF+'"onclick="(function (){ var el = document.getElementById(\''+this.videoTagId+"'); var img = document.getElementById('img_"+this.videoTagId+"'); if(el.muted) { el.muted = false; img.setAttribute('src', '"+this.ICON_SPEAKER_ON+"'); } else {el.muted = true; img.setAttribute('src', '"+this.ICON_SPEAKER_OFF+"'); }})()\" />";-1!==navigator.userAgent.toLowerCase().indexOf("firefox")?a=b+a+this.link(this.getVideoMaskTagForFFAndIE9())+this.getTagForVideo()+"</div>":navigator.userAgent.toLowerCase().match("ie 9.0.*trident/5.0")?
(b=(this.advertisement.getElement().offsetWidth-this.getWidth())/2+1,a='<div style="position: relative; text-align: center;">'+a.replace(/display:block/,"display:none").replace(/left:1px/,"left:"+b+"px")+this.link(this.getVideoMaskTagForFFAndIE9())+this.getTagForIE9Video()+"</div>"):a=b+a+this.link(this.getTagForVideo())}}else this.isText()?a=this.link(this.getBannertext()):this.isImage()?a=this.link(this.getTagForImage()):this.isHtml()&&(a=this.getTagForHtml());return a},getCloseableButtonHtml:function(){document.getElementById(this.advertisement.closeableActionElementId).style.width=
this.getWidth()+"px";var a="close_"+this.advertisement.elementId+"_"+this.getRandomId();return"<a href='javascript:void(0);' id=\""+a+'" onclick="(function (){ var adel = document.getElementById(\''+this.advertisement.elementId+"');var btnel = document.getElementById('"+a+"');if (adel.style.height !== '0px') {btnel.textContent = '"+this.advertisement.closeableButtonText[1]+"';adel.style.height = '0px';} else {btnel.textContent = '"+this.advertisement.closeableButtonText[0]+"';adel.style.height = '"+
this.getHeight()+"px'}})();\">"+this.advertisement.closeableButtonText[0]+"</a></div>"},getTextLinkTag:function(){return this.hasTextLink()?this.link(this.getBannertext()):""},canPlayEventListener:function(){var a=document.getElementById(this.videoTagId);a.style.display="inline";a.muted=!0;var b=0,c=this,e=setInterval(function(){var a=document.getElementById(c.videoTagId);a=parseInt(Math.ceil(a.currentTime/a.duration*100)/25);b<a&&(b=a,d.Api.logEvent(c.response.bannerid,c.response.zoneid,b,c.logimpressionCallback),
4<=b&&clearTimeout(e))},200)},logimpressionCallback:function(a){if(!a.success&&a.message)throw Error(a.message);},getRandomId:function(){for(var a="",b=0;5>b;b++)a+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(Math.floor(52*Math.random()));return a+"_"+(new Date).getTime()},getBannertext:function(){return this.response.bannertext||""},getAppend:function(){return this.response.append||""},getTagForImage:function(){var a="src";this.getLazyLoadUrlName()&&(a=this.getLazyLoadUrlName());
a='<img %SRC_NAME%="%IMAGE_PATH%" alt="%BANNERTEXT%" width="%WIDTH%" height="%HEIGHT%" border="0" />'.replace("%SRC_NAME%",a);a=a.replace("%IMAGE_PATH%",this.getImagePath());a=a.replace("%BANNERTEXT%",this.getBannertext());a=a.replace("%WIDTH%",this.getWidth());return a=a.replace("%HEIGHT%",this.getHeight())},getVideoMaskTagForFFAndIE9:function(){var a=(this.advertisement.getElement().offsetWidth-this.getWidth())/2;a='<img src="data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEHAAIALAAAAAABAAEAAAICVAEAOw==" style="position: absolute; top: 0; left: %LEFT%px; width:%WIDTH%px; height:%HEIGHT%px; z-index: 1; border: none;">'.replace("%LEFT%",
a);a=a.replace("%WIDTH%",this.getWidth());return a=a.replace("%HEIGHT%",this.getHeight())},getTagForVideo:function(){var a='<video id="'+this.videoTagId+'" width="%WIDTH%" height="%HEIGHT%" autoplay muted style="background-color: #000; z-index: 0; display: none;"><source src="%VIDEOPATH%" type="video/mp4"></video>';a=a.replace("%WIDTH%",this.getWidth());a=a.replace("%HEIGHT%",this.getHeight());return a=a.replace("%VIDEOPATH%",this.getVideoPath())},getTagForIE9Video:function(){var a='<video poster="data:image/gif;base64,R0lGODlhAQABAJEAAAAAAP///////wAAACH5BAEHAAIALAAAAAABAAEAAAICVAEAOw==" id="'+
this.videoTagId+'" width="%WIDTH%" height="%HEIGHT%" autoplay style="background-color: #000; z-index: 0; display: none;" oncanplay="(function () { document.getElementById(\''+this.videoTagId+"').style.display = 'block'; document.getElementById('img_"+this.videoTagId+"').style.display = 'block'; document.getElementById('"+this.videoTagId+'\').muted = true;})()"><source src="%VIDEOPATH%" type="video/mp4"></video>';a=a.replace("%WIDTH%",this.getWidth());a=a.replace("%HEIGHT%",this.getHeight());return a=
a.replace("%VIDEOPATH%",this.getVideoPath())},getTagForHtml:function(){var a="ads_"+this.response.zoneid+"_"+this.getRandomId();if(1===this.response.use_adaptive_height){var b=this.getBannertextPath(a);var c="Ads.__internal__.Utility.postRequestMessageToIframe(document.getElementById('"+a+"'));";e.iframeResizeRetryCounts[a]=0}else b=this.getBannertextPath(""),c="";var d=this.getUserAgent(),f=this.isSafari(d)?"allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts":
"allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation";d=this.needOfSandbox(d)?'sandbox="'+f+'" ':"";f='src="';this.getLazyLoadUrlName()&&(f=this.getLazyLoadUrlName()+'="');return"<iframe "+d+f+b+'" id="'+a+'" name="'+a+'" onload="'+c+'" style="border:0;margin:0;overflow:hidden;resize:none;" width="'+this.getWidth()+'" height="'+this.getHeight()+'" allowTransparency="true" ></iframe>'},getBrowserVersion:function(a,
b){return(b=(new RegExp(a+"/[0-9]*","")).exec(b))?b[0].slice(a.length+1):!1},isOpera:function(a){return 0<a.indexOf("chrome")&&0<a.indexOf("safari")&&0<a.indexOf("opr/")?!0:!1},isChrome:function(a){return 0<a.indexOf("chrome")?!0:!1},isFirefox:function(a){return 0<a.indexOf("firefox")?!0:!1},isAndroid:function(a){return 0<a.indexOf("windows phone")?!1:0<a.indexOf("android")?!0:!1},isAndroidMobile:function(a){return 0<a.indexOf("windows phone")?!1:0<a.indexOf("android")&&0<a.indexOf("mobile")?!0:!1},
isWidowsPhone:function(a){return 0<a.indexOf("windows phone")?!0:!1},isIos:function(a){return 0<a.indexOf("iphone")||0<a.indexOf("ipad")?!0:!1},isSp:function(a){return this.isAndroid(a)||this.isIos(a)||this.isWidowsPhone(a)?!0:!1},isSafari:function(a){return 0<a.indexOf("safari")?0<a.indexOf("chrome")?!1:!0:!1},isIE10:function(a){return-1!==a.indexOf("msie 10.")?!0:!1},isIE9:function(a){return-1!==a.indexOf("msie 9.")?!0:!1},isIE:function(a){return-1!==a.indexOf("trident/")&&-1!==a.indexOf("rv:11.0")?
!0:this.isIE10(a)||this.isIE9(a)},isEdge:function(a){return-1!==a.indexOf("edge")?!0:!1},isMicrosoft:function(a){return this.isEdge(a)||this.isIE(a)?!0:!1},needOfSandbox:function(a){if(this.isSp(a)||this.isMicrosoft(a))return!1;if(this.isOpera(a)){var b=this.getBrowserVersion("opr",a);if(!1!==b)return parseInt(b),34<=b?!0:!1}return this.isChrome(a)&&(b=this.getBrowserVersion("chrome",a),!1!==b)?(parseInt(b),46<=b?!0:!1):this.isFirefox(a)&&(b=this.getBrowserVersion("firefox",a),!1!==b)?(parseInt(b),
49<=b?!0:!1):this.isSafari(a)&&(b=this.getBrowserVersion("safari",a),!1!==b&&(parseInt(b),604<=b))?!0:!1},getUserAgent:function(){return window.navigator.userAgent.toLowerCase()},getImagePath:function(){return e.pathBase+"/assets/images/"+this.response.filename},getVideoPath:function(){return e.resBase+"/"+this.response.filename},getClickPath:function(){return e.pathBase+"/click?"+d.Utility.toQueryString({bannerid:this.response.bannerid,zoneid:this.response.zoneid})},getBannertextPath:function(a){return e.pathBase+
"/bannertext?"+d.Utility.toQueryString({bannerid:this.response.bannerid,did:e.did,frameId:a,zoneid:this.response.zoneid})},getWidth:function(){return null!=this.advertisement.width&&0<this.advertisement.width?this.advertisement.width:null!=this.response.width&&0<this.response.width?this.response.width:this.advertisement.getElement().offsetWidth||0},getHeight:function(){return null!=this.advertisement.height&&0<this.advertisement.height?this.advertisement.height:null!=this.response.width&&0<this.response.width&&
null!=this.response.height&&0<this.response.height&&!0===this.advertisement.keepAspectRatio&&null!=this.advertisement.width&&0<this.advertisement.width?this.advertisement.width*this.response.height/this.response.width:null!=this.response.height&&0<this.response.height?this.response.height:this.advertisement.getElement().offsetHeight||0},link:function(a){var b='<a href="%CLICK_PATH%" target="_blank" rel="noopener">%HTML%</a>'.replace("%CLICK_PATH%",this.getClickPath());return b=b.replace("%HTML%",
a)},isImage:function(){return"gif"===this.response.contenttype||"jpeg"===this.response.contenttype||"png"===this.response.contenttype},isText:function(){return"txt"===this.response.contenttype},hasTextLink:function(){return!this.isHtml()&&!!this.response.bannertext},isHtml:function(){return"html"===this.response.contenttype},isVideo:function(){return"mp4"===this.response.contenttype},isLazyLoad:function(){return!0===this.response.uselazyload},setLazyLoadUrlName:function(a){this.lazyLoadUrlName=a},
getLazyLoadUrlName:function(){return this.lazyLoadUrlName},getString:function(){return"function"===typeof this.advertisement.template?(this.getString=function(){return this.getTag()},this.advertisement.template.apply(this)):this.getTag()}})})()},function(g,h){(function(){var f=(new Function("return this;"))(),e=f.Ads,d=f.Ads.__internal__;e.View=d.Class.create();d.Utility.extend(e.View.prototype,{advertisement:null,responses:[],display:function(a,b){this.advertisement=a;this.responses=b;for(var c=
0;c<b.length;c++){var e=b[c],f=new d.Template(a,e),g=f.isLazyLoad()||this.advertisement.forceLazyLoad;g&&f.setLazyLoadUrlName(this.advertisement.lazyLoadUrlName?this.advertisement.lazyLoadUrlName:"nico-ads-src");var h=f.getString();h&&("undefined"!==typeof this.advertisement.closeableActionElementId&&null!==this.advertisement.closeableActionElementId&&document.getElementById(this.advertisement.closeableActionElementId).insertAdjacentHTML("beforeend",f.getCloseableButtonHtml()),d.Utility.updateElement(a.getElement(),
h)&&void 0!=h.match("<video")&&document.getElementById(f.videoTagId).addEventListener("canplay",f.canPlayEventListener.bind(f)),g&&(g="100px",this.advertisement.lazyLoadViewMargin&&(g=this.advertisement.lazyLoadViewMargin),h=this.advertisement.lazyLoadUrlName?this.advertisement.lazyLoadUrlName:"nico-ads-src",f=a.getElement().querySelectorAll("["+h+"]"),d.Utility.observationLazyLoad(f,g,h)));if(1===a.impression&&(d.Api.logImpression(e.campaignid,e.bannerid,e.zoneid,this.logimpressionCallback),Array.isArray(e.imp_track_urls)))for(f=
0;f<e.imp_track_urls.length;f++)(new Image).src=d.Utility.replaceTimestampToRandomString(e.imp_track_urls[f]);if(3===a.impression||1===a.impression)g=this.advertisement.viewImpThreshold||.5,h=this.advertisement.viewImpDelay||1E3,f=a.getElement().querySelectorAll("img, iframe"),d.Utility.observationViewableImpression(f,e.campaignid,e.bannerid,e.zoneid,this.logimpressionCallback,g,h)}},update:function(){var a=this.advertisement.getElement();a&&a.innerHTML&&(a.innerHTML="");this.advertisement.set(this.advertisement.elementId,
this.advertisement.template)},logimpressionCallback:function(a){if(!a.success&&a.message)throw Error(a.message);}})})()},function(g,h){(function(){function f(){(function(){function a(a){this.time=a.time;this.target=a.target;this.rootBounds=a.rootBounds;this.boundingClientRect=a.boundingClientRect;this.intersectionRect=a.intersectionRect||h();this.isIntersecting=!!a.intersectionRect;a=this.boundingClientRect;a=a.width*a.height;var b=this.intersectionRect;b=b.width*b.height;this.intersectionRatio=a?
Number((b/a).toFixed(4)):this.isIntersecting?1:0}function b(a,b){b=b||{};if("function"!=typeof a)throw Error("callback must be a function");if(b.root&&1!=b.root.nodeType)throw Error("root must be an Element");this._checkForIntersections=c(this._checkForIntersections.bind(this),this.THROTTLE_TIMEOUT);this._callback=a;this._observationTargets=[];this._queuedEntries=[];this._rootMarginValues=this._parseRootMargin(b.rootMargin);this.thresholds=this._initThresholds(b.threshold);this.root=b.root||null;
this.rootMargin=this._rootMarginValues.map(function(a){return a.value+a.unit}).join(" ")}function c(a,b){var c=null;return function(){c||(c=setTimeout(function(){a();c=null},b))}}function d(a,b,c,d){"function"==typeof a.addEventListener?a.addEventListener(b,c,d||!1):"function"==typeof a.attachEvent&&a.attachEvent("on"+b,c)}function f(a,b,c,d){"function"==typeof a.removeEventListener?a.removeEventListener(b,c,d||!1):"function"==typeof a.detatchEvent&&a.detatchEvent("on"+b,c)}function g(a){try{var b=
a.getBoundingClientRect()}catch(v){}if(!b)return h();b.width&&b.height||(b={top:b.top,right:b.right,bottom:b.bottom,left:b.left,width:b.right-b.left,height:b.bottom-b.top});return b}function h(){return{top:0,bottom:0,left:0,right:0,width:0,height:0}}function l(a,b){for(;b;){if(b==a)return!0;b=r(b)}return!1}function r(a){return(a=a.parentNode)&&11==a.nodeType&&a.host?a.host:a&&a.assignedSlot?a.assignedSlot.parentNode:a}if("object"===typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in
window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return 0<this.intersectionRatio}});else{var m=window.document,n=[];b.prototype.THROTTLE_TIMEOUT=100;b.prototype.POLL_INTERVAL=null;b.prototype.USE_MUTATION_OBSERVER=!0;b.prototype.observe=function(a){if(!this._observationTargets.some(function(b){return b.element==a})){if(!a||
1!=a.nodeType)throw Error("target must be an Element");this._registerInstance();this._observationTargets.push({element:a,entry:null});this._monitorIntersections();this._checkForIntersections()}};b.prototype.unobserve=function(a){this._observationTargets=this._observationTargets.filter(function(b){return b.element!=a});this._observationTargets.length||(this._unmonitorIntersections(),this._unregisterInstance())};b.prototype.disconnect=function(){this._observationTargets=[];this._unmonitorIntersections();
this._unregisterInstance()};b.prototype.takeRecords=function(){var a=this._queuedEntries.slice();this._queuedEntries=[];return a};b.prototype._initThresholds=function(a){a=a||[0];Array.isArray(a)||(a=[a]);return a.sort().filter(function(a,b,c){if("number"!=typeof a||isNaN(a)||0>a||1<a)throw Error("threshold must be a number between 0 and 1 inclusively");return a!==c[b-1]})};b.prototype._parseRootMargin=function(a){a=(a||"0px").split(/\s+/).map(function(a){a=/^(-?\d*\.?\d+)(px|%)$/.exec(a);if(!a)throw Error("rootMargin must be specified in pixels or percent");
return{value:parseFloat(a[1]),unit:a[2]}});a[1]=a[1]||a[0];a[2]=a[2]||a[0];a[3]=a[3]||a[1];return a};b.prototype._monitorIntersections=function(){this._monitoringIntersections||(this._monitoringIntersections=!0,this.POLL_INTERVAL?this._monitoringInterval=setInterval(this._checkForIntersections,this.POLL_INTERVAL):(d(window,"resize",this._checkForIntersections,!0),d(m,"scroll",this._checkForIntersections,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in window&&(this._domObserver=new MutationObserver(this._checkForIntersections),
this._domObserver.observe(m,{attributes:!0,childList:!0,characterData:!0,subtree:!0}))))};b.prototype._unmonitorIntersections=function(){this._monitoringIntersections&&(this._monitoringIntersections=!1,clearInterval(this._monitoringInterval),this._monitoringInterval=null,f(window,"resize",this._checkForIntersections,!0),f(m,"scroll",this._checkForIntersections,!0),this._domObserver&&(this._domObserver.disconnect(),this._domObserver=null))};b.prototype._checkForIntersections=function(){var b=this._rootIsInDom(),
c=b?this._getRootRect():h();this._observationTargets.forEach(function(d){var e=d.element,f=g(e),h=this._rootContainsTarget(e),q=d.entry,k=b&&h&&this._computeTargetAndRootIntersection(e,c);d=d.entry=new a({time:window.performance&&performance.now&&performance.now(),target:e,boundingClientRect:f,rootBounds:c,intersectionRect:k});q?b&&h?this._hasCrossedThreshold(q,d)&&this._queuedEntries.push(d):q&&q.isIntersecting&&this._queuedEntries.push(d):this._queuedEntries.push(d)},this);this._queuedEntries.length&&
this._callback(this.takeRecords(),this)};b.prototype._computeTargetAndRootIntersection=function(a,b){if("none"!=window.getComputedStyle(a).display){var c=g(a);a=r(a);for(var d=!1;!d;){var e=null,f=1==a.nodeType?window.getComputedStyle(a):{};if("none"==f.display)return;a==this.root||a==m?(d=!0,e=b):a!=m.body&&a!=m.documentElement&&"visible"!=f.overflow&&(e=g(a));if(e){f=Math.max(e.top,c.top);var h=Math.min(e.bottom,c.bottom),q=Math.max(e.left,c.left);c=Math.min(e.right,c.right);e=c-q;var k=h-f;c=0<=
e&&0<=k&&{top:f,bottom:h,left:q,right:c,width:e,height:k};if(!c)break}a=r(a)}return c}};b.prototype._getRootRect=function(){if(this.root)var a=g(this.root);else{a=m.documentElement;var b=m.body;a={top:0,left:0,right:a.clientWidth||b.clientWidth,width:a.clientWidth||b.clientWidth,bottom:a.clientHeight||b.clientHeight,height:a.clientHeight||b.clientHeight}}return this._expandRectByRootMargin(a)};b.prototype._expandRectByRootMargin=function(a){var b=this._rootMarginValues.map(function(b,c){return"px"==
b.unit?b.value:b.value*(c%2?a.width:a.height)/100});b={top:a.top-b[0],right:a.right+b[1],bottom:a.bottom+b[2],left:a.left-b[3]};b.width=b.right-b.left;b.height=b.bottom-b.top;return b};b.prototype._hasCrossedThreshold=function(a,b){a=a&&a.isIntersecting?a.intersectionRatio||0:-1;b=b.isIntersecting?b.intersectionRatio||0:-1;if(a!==b)for(var c=0;c<this.thresholds.length;c++){var d=this.thresholds[c];if(d==a||d==b||d<a!==d<b)return!0}};b.prototype._rootIsInDom=function(){return!this.root||l(m,this.root)};
b.prototype._rootContainsTarget=function(a){return l(this.root||m,a)};b.prototype._registerInstance=function(){0>n.indexOf(this)&&n.push(this)};b.prototype._unregisterInstance=function(){var a=n.indexOf(this);-1!=a&&n.splice(a,1)};e.IntersectionObserver=b;e.IntersectionObserverEntry=a}})()}var e=(new Function("return this;"))().Ads.__internal__.Polyfill,d="IntersectionObserver"in window;e.isIntersectionObserverPolyfill=!d;d||f()})()},function(g,h){(new Function("return this;"))().Ads.__internal__.Utility.setup()}]);}).call(this || window)
