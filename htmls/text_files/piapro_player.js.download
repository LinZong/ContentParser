var wo = null;
var wo_open = false;

function swf_popup_display(data_id) {
	var content = $('#'+data_id).data('piapro_player');
	wo_open = true;
	if (wo == null) {
		wo = window.open("", "openwindow", "width=397,height=165,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
	}
	if (wo.closed || !thisMovie("external_swf_popup", wo)) {
		var cdate = content.create_date.replace(/ /ig, '%20').replace(/:/ig, '%3A');
		wo = window.open("http://" + location.hostname + "/swf_player_popup/?id=" + content.id + '&cdate=' + cdate, "openwindow", "width=397,height=165,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
		wo_open = false;
	}
	wo.focus();
	setTimeout("popup_exe('" + data_id + "')", 300);
}

function swf_popup_display_s_on(data_id) {
	var content = $('#'+data_id).data('piapro_player');
	wo_open = true;
	if (wo == null) {
		wo = window.open("", "openwindow", "width=447,height=605,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
	}
	if (wo.closed || !thisMovie("external_swf_popup", wo)) {
		var cdate = content.create_date.replace(/ /ig, '%20');
		cdate = cdate.replace(/:/ig, '%3A');
		wo = window.open("http://" + location.hostname + "/swf_player_popup/?id=" + content.id + "&s=1" + '&cdate=' + cdate, "openwindow", "width=447,height=605,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
		wo_open = false;
	}
	wo.focus();
	setTimeout("popup_exe('" + data_id + "')", 300);
}

function swf_popup_display_i(data_id) {
	var content = $('#'+data_id).data('piapro_player');
	wo_open = true;
	if (wo == null) {
		wo = window.open("", "openwindow_i", "width=447,height=665,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
	}
	if (wo.closed || !thisMovie("piapro_player", wo)) {
		wo = window.open("http://" + location.hostname + "/swf_player_popup/?id=" + content.id + "&i=1", "openwindow_i", "width=447,height=665,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
		wo_open = false;
	}
	wo.focus();
	setTimeout("popup_i_exe('" + data_id + "')", 500);
}

function popup_exe(data_id) {
	var content = $('#'+data_id).data('piapro_player');
	if (!wo.closed) {
		wo.del_kbn = content.del_kbn;
		if (wo_open) {
			var is_init = wo.del_kbn == '0' ? 1 : 0;
			wo.popup_div_source_display(is_init);
		}
		var swf_movie = thisMovie("external_swf_popup", wo);
		var set_timeout = true;
		if (swf_movie) {
			if ((typeof(swf_movie.swf_load) == 'object' || typeof(swf_movie.swf_load) == 'function') && swf_movie.swf_load() == true) {
				set_timeout = false;
				swf_movie.swf_play(content.id, content.make_date, content.title, content.nickname, content.date, content.s_sec, content.create_date, content.creator, content.pid);
				wo.cid = content.id;
				wo.ctitle = content.title;
				wo.bp_c_change(Number(get_cookie('c')));
			}
		}
		if (set_timeout) {
			setTimeout("popup_exe('" + data_id + "')", 300);
		}
	}
}

function popup_i_exe(data_id) {
	var content = $('#'+data_id).data('piapro_player');
	if (!wo.closed) {
		wo.del_kbn = content.del_kbn;
		if (wo_open) {
			var is_init = wo.del_kbn == '0' ? 1 : 0;
			wo.popup_div_source_display(0);
		}
		var swf_movie = thisMovie("piapro_player", wo);
		var set_timeout = true;
		if (swf_movie) {
			if ((typeof(swf_movie.swf_load) == 'object' || typeof(swf_movie.swf_load) == 'function') && swf_movie.swf_load() == true) {
				set_timeout = false;
				swf_movie.swf_play(content.id);
				wo.cid = content.id;
				wo.ctitle = content.title;
				wo.bp_s_change();
			}
		}
		if (set_timeout) {
			setTimeout("popup_i_exe('" + data_id + "')", 300);
		}
	}
}

function thisMovie(movieName, wo) {
	if (navigator.appName.indexOf("Microsoft") != -1) {
		return wo[movieName];
	} else {
		return wo.document[movieName];
	}
}

//	card player with html5
function playCard(p, i, c){
	wo_open = true;
	if (wo == null) {
		wo = window.open("", "openwindow", "width=480,height=700,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
	}
	if (wo.closed || !thisMovie("external_swf_popup", wo)) {
		wo = window.open("http://" + location.hostname + "/html5_player_popup/?id="+i+"&cdate="+c+"&p="+p, "openwindow", "width=480,height=700,toolbar=no,location=no,status=yes,menubar=no,scrollbars=yes,resizable=no");
		wo_open = false;
	}
	wo.focus();
	return false;
}